[gd_scene load_steps=22 format=3 uid="uid://347rkxj6e7d4"]

[ext_resource type="Script" path="res://scenes/objects/pickable_items/equipment/ranged/double-barrel_sawed_shotgun/effects.gd" id="1"]
[ext_resource type="AudioStream" uid="uid://5yf0bei0ff5s" path="res://resources/sounds/dryfire/46265__phreaksaccount__coachgun_dry_fire.wav" id="2"]
[ext_resource type="AudioStream" uid="uid://bbqik4i4cjre" path="res://resources/sounds/reloading/shotgun/shotgun_reload_2.wav" id="3"]
[ext_resource type="PackedScene" uid="uid://dmwv4wqqycha6" path="res://resources/models/items/ranged/double_barrel_shotguns/DoubleBarrelSawed.glb" id="3_a0rfu"]
[ext_resource type="Resource" path="res://resources/tiny_items/ammunition/shotgun_shell.tres" id="4"]
[ext_resource type="PackedScene" uid="uid://ebncv186qb3c" path="res://scenes/effects/shotgun_audio.tscn" id="5"]
[ext_resource type="PackedScene" path="res://scenes/effects/hit_effect.tscn" id="6"]
[ext_resource type="PackedScene" path="res://scenes/objects/pickable_items/equipment/ranged/_gun_item.tscn" id="7"]
[ext_resource type="PackedScene" path="res://scenes/objects/pickable_items/equipment/ranged/double-barrel_sawed_shotgun/_smoke.tscn" id="8"]
[ext_resource type="AudioStream" uid="uid://biqwhqeb70a3r" path="res://resources/sounds/reloading/ammo_pickup/422716__niamhd00145229__reload-ammo.ogg" id="10"]
[ext_resource type="Script" path="res://scenes/objects/pickable_items/equipment/ranged/double-barrel_sawed_shotgun/shell_reload_effects.gd" id="11"]
[ext_resource type="Animation" uid="uid://d10b721b7i1j5" path="res://resources/animations/sawed-off_shotgun_reload-weapon.res" id="12_rd4e5"]
[ext_resource type="Script" path="res://scenes/effects/mesh_instances.gd" id="13"]

[sub_resource type="Skin" id="7"]
resource_name = "Skin"
bind_count = 5
bind/0/name = &"Root"
bind/0/bone = -1
bind/0/pose = Transform3D(0.352139, -0.935948, -1.04945e-08, 0.935948, 0.352139, -2.78934e-08, 2.78934e-08, 1.04945e-08, 1, 0.0892714, 0.258829, -1.33847e-07)
bind/1/name = &"BarrelBreak"
bind/1/bone = -1
bind/1/pose = Transform3D(0.00579363, -0.999983, -1.09573e-06, 0.999983, 0.00579363, -2.60209e-09, 7.0414e-09, -1.0852e-06, 1, 0.0399706, 0.0367814, -3.58147e-08)
bind/2/name = &"Trigger1"
bind/2/bone = -1
bind/2/pose = Transform3D(-0.994863, -0.101226, -6.09178e-07, 0.101226, -0.994863, -7.20675e-08, -6.00662e-07, -1.22867e-07, 1, -0.131622, 0.0345066, 0.00214472)
bind/3/name = &"Trigger2"
bind/3/bone = -1
bind/3/pose = Transform3D(-0.875356, 0.483479, 2.64592e-07, -0.483479, -0.875356, -6.27061e-08, 1.99386e-07, -1.7232e-07, 1, -0.132773, -0.0514278, -0.00262755)
bind/4/name = &"BreakLatch"
bind/4/bone = -1
bind/4/pose = Transform3D(-6.37646e-05, -1.19916e-07, -1, -0.980782, -0.195106, 6.24604e-05, -0.195106, 0.980782, 1.23037e-05, -6.29214e-06, -0.0819429, -0.0958337)

[sub_resource type="ConvexPolygonShape3D" id="8"]
points = PackedVector3Array(-0.0874182, 0.0817786, 0.00620462, -0.0874182, 0.0811487, 0.0114065, 0.257315, 0.0761949, 0.00297166, -0.0874182, 0.0817786, -0.00621066, -0.156987, 0.0712125, 0.00150103, -0.0874182, 0.0808051, 0.0131263, 0.257315, 0.0732885, 0.017599, 0.257315, 0.0741046, 0.0135031, 0.257315, 0.0761949, -0.00296555, -0.0874182, 0.0811487, -0.0114126, -0.156987, 0.0712125, -0.00149492, -0.254261, 0.0267429, 1.86265e-08, -0.253428, 0.0256834, 0.00551792, -0.252373, 0.0238938, 0.0110905, -0.231663, 0.0325558, 0.011838, -0.14244, 0.063023, 0.0257664, -0.134723, 0.0657003, 0.0261979, -0.0874182, 0.0779989, 0.0231351, -0.0874182, 0.0788293, 0.0207651, -0.0874182, 0.0796167, 0.0179393, -0.0874182, 0.0803755, 0.0150952, 0.257315, 0.0709691, 0.021075, -0.0874182, 0.0755792, 0.0270851, 0.257315, 0.0741046, -0.013497, 0.257315, 0.0732885, -0.0175928, -0.0874182, 0.0808051, -0.0131323, -0.134723, 0.0657003, -0.0261918, -0.14244, 0.063023, -0.0257603, -0.231663, 0.0325558, -0.0118319, -0.252373, 0.0238938, -0.0110844, -0.253428, 0.0256834, -0.00551181, -0.0874182, 0.0803755, -0.0151013, -0.0874182, 0.0796167, -0.0179453, -0.0874182, 0.0788293, -0.0207711, -0.0874182, 0.0779989, -0.0231411, -0.268585, 0.0178376, -0.00520796, -0.269196, 0.0188684, 1.86265e-08, -0.268585, 0.0178376, 0.00521407, -0.26753, 0.0163772, 0.0103491, -0.265976, 0.0145732, 0.0146456, -0.250818, 0.0209731, 0.0156483, -0.264865, 0.0117384, 0.017599, -0.248986, 0.016821, 0.0197198, -0.150935, 0.0568665, 0.026204, -0.0874182, 0.0676188, 0.0306037, -0.0874182, 0.0722004, 0.0289447, 0.257315, 0.06749, 0.0233964, 0.257315, 0.0709691, -0.0210689, -0.0874182, 0.0755792, -0.0270912, -0.150935, 0.0568665, -0.0261979, -0.0874182, 0.0722004, -0.0289507, -0.0874182, 0.0676188, -0.0306097, -0.248986, 0.016821, -0.0197198, -0.264865, 0.0117384, -0.0175928, -0.250818, 0.0209731, -0.0156421, -0.265976, 0.0145732, -0.0146455, -0.26753, 0.0163772, -0.010343, -0.282243, 0.00671303, -0.00558473, -0.282688, 0.00714254, -2.42889e-05, -0.282243, 0.00671303, 0.00556654, -0.280134, 0.00568219, 0.0110905, -0.274804, 0.00479451, 0.0163775, -0.259757, 0.00641236, 0.0201088, -0.28663, -0.00797652, 0.017994, -0.247542, 0.0131845, 0.0208501, -0.232052, 0.0202715, 0.0217435, -0.157042, 0.0526, 0.026204, -0.0874182, 0.0631375, 0.0310412, 0.257315, 0.0633952, 0.0242107, 0.257315, 0.06749, -0.0233903, -0.157042, 0.0526, -0.0261979, -0.232052, 0.0202715, -0.0217374, 0.257315, 0.0633952, -0.0242046, -0.0874182, 0.0631375, -0.0310412, -0.247542, 0.0131845, -0.020844, -0.259757, 0.00641236, -0.0201026, -0.274859, 0.00482314, -0.016341, -0.286796, -0.0077904, -0.0174774, -0.280134, 0.00568219, -0.0110844, -0.289628, -0.00618686, -0.0119959, -0.291293, -0.00524192, -0.00599796, -0.291904, -0.00492694, 0.000109404, -0.291293, -0.00527055, 0.00616208, -0.289628, -0.00622981, 0.0120628, -0.170201, 0.0264995, 0.0263559, -0.171811, 0.0324412, 0.0262708, -0.295513, -0.0155074, 0.012154, -0.292626, -0.0172971, 0.0169366, -0.301454, -0.0327884, 0.0156057, -0.295346, -0.0393744, 0.0160372, -0.169646, 0.0383686, 0.026204, -0.204791, 0.0297066, 0.0235969, -0.163649, 0.0456847, 0.026204, -0.0220692, 0.0322551, 0.0265321, -0.00891063, 0.0362353, 0.0267813, -0.158264, 0.0205149, 0.026204, -0.148658, 0.0182814, 0.026204, -0.140108, 0.0169499, 0.026204, -0.122841, 0.0179807, 0.0261979, 0.257315, 0.0593005, 0.0233964, -0.163649, 0.0456847, -0.0261979, -0.204791, 0.0297066, -0.0235908, 0.257315, 0.0593005, -0.0233903, -0.0220692, 0.0322551, -0.026526, -0.00891063, 0.0362353, -0.0267752, -0.122841, 0.0179807, -0.0261918, -0.140108, 0.0169499, -0.0261979, -0.148658, 0.0182814, -0.0261979, -0.158264, 0.0205149, -0.0261979, -0.170201, 0.0264995, -0.0263498, -0.171811, 0.0324412, -0.0262647, -0.169646, 0.0383686, -0.0261979, -0.278412, -0.0100668, -0.0183099, -0.292626, -0.0172971, -0.0169305, -0.295513, -0.0155074, -0.0121479, -0.297068, -0.0146627, -0.00628966, -0.297789, -0.014362, -0.000115443, -0.297068, -0.0146627, 0.00617423, -0.264865, -0.0434405, 0.0172161, -0.300121, -0.0236826, 0.0114187, -0.297623, -0.0255725, 0.0161162, -0.303231, -0.0305979, 0.0117225, -0.30745, -0.0415792, 0.0109811, -0.305507, -0.0428821, 0.0143964, -0.298456, -0.0472346, 0.0144754, -0.264032, -0.0542214, 0.0159643, -0.267142, -0.0484802, 0.0165051, 0.257315, 0.0558214, 0.021075, -0.261645, -0.0594329, 0.0137158, 0.257315, 0.0558214, -0.0210689, -0.261645, -0.0594329, -0.0137097, -0.264032, -0.0542214, -0.0159581, -0.264865, -0.0434405, -0.01721, -0.295346, -0.0393744, -0.0160311, -0.285741, -0.020318, -0.0174288, -0.297567, -0.0256154, -0.0162924, -0.300066, -0.0236683, -0.0115766, -0.301287, -0.023296, -0.00585819, -0.301787, -0.0232674, -0.000212675, -0.301287, -0.0233247, 0.00557869, -0.303786, -0.0291661, 0.00525661, -0.30845, -0.0409922, 0.00478261, -0.309782, -0.0546939, 0.00752332, -0.309005, -0.0550089, 0.011127, -0.300677, -0.056326, 0.0113579, -0.282077, -0.0603349, 0.0113457, -0.26753, -0.059662, 0.0130777, 0.257315, 0.053502, 0.017599, -0.260423, -0.0627831, 0.00876911, -0.281633, -0.0632986, 0.0079244, -0.266531, -0.0631268, 0.00861718, 0.257315, 0.053502, -0.0175928, -0.260423, -0.0627831, -0.00876907, -0.266531, -0.0631268, -0.00861714, -0.281633, -0.0632986, -0.00791829, -0.26753, -0.059662, -0.0130716, -0.309005, -0.0549945, -0.0113882, -0.298456, -0.0472346, -0.0144693, -0.267142, -0.0484802, -0.016499, -0.305507, -0.0428678, -0.0145604, -0.301454, -0.0327884, -0.0157272, -0.303231, -0.0305979, -0.0117407, -0.303786, -0.0291661, -0.00525049, -0.30845, -0.0409922, -0.00477649, -0.308505, -0.0409779, 1.86265e-08, -0.309893, -0.0546796, 0.00323905, -0.309393, -0.0575716, 1.86265e-08, -0.30906, -0.0575001, 0.00746255, 0.257315, 0.0526859, 0.0135031, -0.265754, -0.0644869, 1.86265e-08, -0.259757, -0.0638426, 1.86265e-08, -0.281355, -0.0642149, 1.86265e-08, 0.257315, 0.0526859, -0.013497, -0.309116, -0.0574714, -0.0077846, -0.282077, -0.0603349, -0.0113396, -0.309782, -0.0546939, -0.00751721, -0.307506, -0.0415649, -0.0109993, -0.309893, -0.0546796, -0.00359756, -0.309893, -0.0547082, 1.86265e-08, -0.30101, -0.0597336, 1.86265e-08, 0.257315, 0.0523136, 0.00235789, 0.257315, 0.0523136, -0.00235177)

[sub_resource type="Animation" id="15"]
resource_name = "break_open_weapon"
length = 1.36667

[sub_resource type="Animation" id="16"]
resource_name = "close_breech_weapon"
length = 1.66667

[sub_resource type="Animation" id="17"]
resource_name = "enter_shell_1_weapon"
length = 0.866667

[sub_resource type="Animation" id="18"]
resource_name = "enter_shell_2_weapon"
length = 1.06667

[sub_resource type="AnimationLibrary" id="AnimationLibrary_0qr5e"]
_data = {
"break_open_weapon": SubResource("15"),
"close_breech_weapon": SubResource("16"),
"enter_shell_1_weapon": SubResource("17"),
"enter_shell_2_weapon": SubResource("18")
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_0wtng"]
_data = {
"reload": ExtResource("12_rd4e5")
}

[node name="SawedOffShotgun" instance=ExtResource("7")]
mass = 3.0
ammo_types = Array[Resource]([ExtResource("4")])
ammunition_capacity = 2
reload_amount = 2
damage_offset = -2
dispersion_offset_degrees = 5
cooldown = 0.1
handling = 3.0
ads_hold_position = Vector3(-0.019, 0.026, -0.136)
ads_hold_rotation = Vector3(-4.559, 1.717, 10.901)
melee_style = 1
player_path = NodePath(".")
detection_raycast = NodePath("RayCast3D")
item_size = 0
item_name = "Sawed-off shotgun"
can_spin = true

[node name="DoubleBarrelSawed" parent="." index="0" instance=ExtResource("3_a0rfu")]
transform = Transform3D(-0.994928, 0, 0.100587, 0, 1, 0, -0.100587, 0, -0.994928, -0.157422, -1.19571, 0.556376)

[node name="DoubleBarrelSawed_Arm" parent="DoubleBarrelSawed" index="0"]
transform = Transform3D(0.0946754, -0.00357224, -0.995502, 0.0290304, 0.999578, -0.000825983, 0.995085, -0.0288216, 0.0947392, -0.0916572, 1.19721, 0.654657)

[node name="Skeleton3D" parent="DoubleBarrelSawed/DoubleBarrelSawed_Arm" index="0"]
bones/1/rotation = Quaternion(8.39185e-08, 5.98601e-07, -0.176107, 0.984371)
bones/4/rotation = Quaternion(-0.703679, -0.0693164, 0.703724, -0.0693122)

[node name="DoubleBarrelSawed_Mesh" parent="DoubleBarrelSawed/DoubleBarrelSawed_Arm/Skeleton3D" index="0"]
script = ExtResource("13")

[node name="ShellPosition1" type="Marker3D" parent="DoubleBarrelSawed/DoubleBarrelSawed_Arm/Skeleton3D/DoubleBarrelSawed_Mesh" index="0"]
unique_name_in_owner = true
transform = Transform3D(0.999561, 0.0290304, 0.0058978, -0.0290348, 0.999578, 0.000655029, -0.00587628, -0.000825983, 0.999982, -0.0616452, 0.0314183, -0.0127337)

[node name="ShellPosition2" type="Marker3D" parent="DoubleBarrelSawed/DoubleBarrelSawed_Arm/Skeleton3D/DoubleBarrelSawed_Mesh" index="1"]
unique_name_in_owner = true
transform = Transform3D(0.999561, 0.0290304, 0.0058978, -0.0290348, 0.999578, 0.000655029, -0.00587628, -0.000825983, 0.999982, -0.0619921, 0.031755, 0.0156228)

[node name="MeshInstance3D" parent="." index="1"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, -0.0373861, -0.110365)
mesh = null
skin = SubResource("7")
script = null

[node name="CollisionShape3D" parent="." index="2"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, -0.0373861, -0.110365)
shape = SubResource("8")

[node name="Effects" type="Node3D" parent="." index="6"]
script = ExtResource("1")
smoke_particles = ExtResource("8")
sound_effect = ExtResource("5")
hit_effect = ExtResource("6")

[node name="Flash" type="OmniLight3D" parent="Effects" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.381674)
visible = false
light_color = Color(0.760784, 0.364706, 0.0470588, 1)
light_energy = 5.0
shadow_enabled = true
omni_range = 9.0
omni_attenuation = 7.0

[node name="FlashTimer" type="Timer" parent="Effects/Flash" index="0"]
one_shot = true

[node name="SmokeOrigin" type="Marker3D" parent="Effects" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0264926, -0.38389)

[node name="SoundOrigin" type="Marker3D" parent="Effects" index="2"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.026, -0.383703)

[node name="RayCast3D" parent="." index="7"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0240571, -0.106174)
visible = true

[node name="Sounds" type="Node3D" parent="." index="8"]

[node name="Unsheath" type="AudioStreamPlayer3D" parent="Sounds" index="0"]
bus = &"Effects"

[node name="Sheath" type="AudioStreamPlayer3D" parent="Sounds" index="1"]
bus = &"Effects"

[node name="Dryfire" type="AudioStreamPlayer3D" parent="Sounds" index="2"]
stream = ExtResource("2")
bus = &"Effects"

[node name="Reload" type="AudioStreamPlayer3D" parent="Sounds" index="3"]
stream = ExtResource("3")
bus = &"Effects"

[node name="Unload" type="AudioStreamPlayer3D" parent="Sounds" index="4"]
stream = ExtResource("10")
bus = &"Effects"

[node name="HoldPosition" parent="." index="9"]
transform = Transform3D(0.983801, -0.159218, -0.0823734, 0.159761, 0.987156, 0, 0.0813154, -0.01316, 0.996602, -0.012, 0.026, -0.116)

[node name="AnimationPlayer" type="AnimationPlayer" parent="." index="10"]
unique_name_in_owner = true
root_node = NodePath("../DoubleBarrelSawed")
libraries = {
"": SubResource("AnimationLibrary_0qr5e"),
"reload": SubResource("AnimationLibrary_0wtng")
}

[node name="ShellReloadEffects" type="Node" parent="AnimationPlayer" index="0"]
script = ExtResource("11")
impulse_position_1 = Vector3(1, 2, 0.5)
impulse_position_2 = Vector3(1, 2, 0.5)

[connection signal="on_shoot" from="." to="Effects" method="_on_ShotgunItem_on_shoot"]
[connection signal="target_hit" from="." to="Effects" method="_on_ShotgunItem_target_hit"]
[connection signal="timeout" from="Effects/Flash/FlashTimer" to="Effects" method="_on_FlashTimer_timeout"]

[editable path="DoubleBarrelSawed"]
