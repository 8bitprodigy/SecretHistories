[gd_scene load_steps=22 format=3 uid="uid://bhp2gv8pijmxh"]

[ext_resource type="Script" path="res://scenes/effects/mesh_instances.gd" id="1"]
[ext_resource type="Script" path="res://scenes/objects/pickable_items/equipment/ranged/double-barrel_shotgun/effects.gd" id="2"]
[ext_resource type="AudioStream" uid="uid://74l856553kcp" path="res://resources/sounds/impacts/491790__hidrolion__42-golpe-metal-1.ogg" id="3"]
[ext_resource type="AudioStream" uid="uid://5yf0bei0ff5s" path="res://resources/sounds/dryfire/46265__phreaksaccount__coachgun_dry_fire.wav" id="4"]
[ext_resource type="AudioStream" uid="uid://cwwsn3iuhstsp" path="res://resources/sounds/reloading/shotgun/shotgun_reload_1.wav" id="5"]
[ext_resource type="Resource" path="res://resources/tiny_items/ammunition/shotgun_shell.tres" id="7"]
[ext_resource type="PackedScene" uid="uid://ebncv186qb3c" path="res://scenes/effects/shotgun_audio.tscn" id="8"]
[ext_resource type="PackedScene" uid="uid://bsp2pcx3vhuuh" path="res://resources/models/items/ranged/double_barrel_shotguns/DoubleBarrel.glb" id="8_6b3p7"]
[ext_resource type="PackedScene" path="res://scenes/objects/pickable_items/equipment/ranged/_gun_item.tscn" id="9"]
[ext_resource type="PackedScene" path="res://scenes/effects/hit_effect.tscn" id="10"]
[ext_resource type="PackedScene" path="res://scenes/objects/pickable_items/equipment/ranged/double-barrel_shotgun/_smoke.tscn" id="11"]
[ext_resource type="AudioStream" uid="uid://biqwhqeb70a3r" path="res://resources/sounds/reloading/ammo_pickup/422716__niamhd00145229__reload-ammo.ogg" id="12"]
[ext_resource type="Script" path="res://scenes/objects/pickable_items/equipment/ranged/double-barrel_sawed_shotgun/shell_reload_effects.gd" id="13"]
[ext_resource type="Animation" uid="uid://dvvsdrao7uv56" path="res://resources/animations/double-barrel_shotgun_reload-weapon.res" id="13_yj4av"]

[sub_resource type="Skin" id="375"]
resource_name = "Skin"
bind_count = 5
bind/0/name = &"Root"
bind/0/bone = -1
bind/0/pose = Transform3D(0.352139, -0.935948, -1.04945e-08, 0.935948, 0.352139, -2.78934e-08, 2.78934e-08, 1.04945e-08, 1, 0.0941305, 0.271744, -1.33462e-07)
bind/1/name = &"BarrelBreak"
bind/1/bone = -1
bind/1/pose = Transform3D(0.00579363, -0.999983, -9.76513e-07, 0.999983, 0.00579363, -2.60206e-09, 6.35072e-09, -9.65987e-07, 1, 0.0399706, 0.0367814, -4.05801e-08)
bind/2/name = &"Trigger1"
bind/2/bone = -1
bind/2/pose = Transform3D(-0.994863, -0.101226, -6.09178e-07, 0.101226, -0.994863, -7.89725e-08, -5.99963e-07, -1.29737e-07, 1, -0.131622, 0.0345066, 0.00214472)
bind/3/name = &"Trigger2"
bind/3/bone = -1
bind/3/pose = Transform3D(-0.875356, 0.483479, 2.64592e-07, -0.483479, -0.875356, -6.27062e-08, 1.99386e-07, -1.7232e-07, 1, -0.132773, -0.0514278, -0.00262755)
bind/4/name = &"BreakLatch"
bind/4/bone = -1
bind/4/pose = Transform3D(-6.37646e-05, -1.19916e-07, -1, -0.980782, -0.195106, 6.24604e-05, -0.195106, 0.980782, 1.23037e-05, -6.29214e-06, -0.0819429, -0.0958337)

[sub_resource type="ConvexPolygonShape3D" id="378"]
points = PackedVector3Array(-0.525527, -0.10884, 0.00583685, -0.075781, 0.0783637, 0.00852547, 0.440931, 0.0736622, 0.0157437, 0.460455, 0.0560691, -0.025732, -0.529027, 0.00692726, -0.0187095, -0.0934038, 0.0713643, 0.0284551, 0.460455, 0.0560691, 0.026898, -0.525527, 0.0279688, 0.0128594, -0.0911653, 0.0762623, -0.0244773, -0.518528, -0.0912796, -0.0152047, -0.518528, -0.0877598, 0.0163707, -0.146513, 0.0139668, -0.0292433, 0.438019, 0.0731478, -0.0178315, -0.518528, -0.10884, -0.00818217, 0.449859, 0.0490489, 0.00584337, -0.0823861, 0.0660763, -0.0297788, -0.525527, 0.0279688, -0.0116935, -0.083435, 0.0597134, 0.029633, 0.460455, 0.0700904, 0.026898, -0.522028, -0.0667182, -0.0187095, -0.518528, -0.101781, 0.0128594, -0.529027, -0.077239, 0.0163707, -0.515029, -0.10884, 0.00583685, 0.449859, 0.0490489, -0.00467089, -0.083697, 0.0748217, 0.0252276, 0.426955, 0.064647, -0.0239567, -0.129015, 0.0139668, -0.0292433, -0.01674, 0.0280073, -0.0292368, -0.524572, -0.0975072, -0.00810295, -0.0754917, 0.0777154, -0.00730164, 0.414572, 0.0739884, -0.00428938, -0.527442, -0.0487746, -0.01504, -0.0980229, 0.0625355, -0.029633, -0.526645, 0.0170914, 0.0127116)

[sub_resource type="Animation" id="382"]
resource_name = "break_open_weapon"
length = 1.38333

[sub_resource type="Animation" id="383"]
resource_name = "close_breech_weapon"
length = 1.66667

[sub_resource type="Animation" id="384"]
resource_name = "enter_shell_1_weapon"
length = 0.866667

[sub_resource type="Animation" id="385"]
resource_name = "enter_shell_2_weapon"
length = 1.06667

[sub_resource type="AnimationLibrary" id="AnimationLibrary_wc5fn"]
_data = {
"break_open_weapon": SubResource("382"),
"close_breech_weapon": SubResource("383"),
"enter_shell_1_weapon": SubResource("384"),
"enter_shell_2_weapon": SubResource("385"),
"reload": ExtResource("13_yj4av")
}

[node name="Double-barrelShotgun" instance=ExtResource("9")]
mass = 3.0
ammo_types = Array[Resource]([ExtResource("7")])
ammunition_capacity = 2
reload_amount = 2
cooldown = 0.1
handling = 7.0
reload_position = Vector3(0.066, 0.041, -0.18)
reload_rotation = Vector3(7.068, -21.912, 0)
ads_hold_position = Vector3(0.053, 0.02, -0.194)
ads_hold_rotation = Vector3(-5.039, -26.317, 13.705)
player_path = NodePath(".")
detection_raycast = NodePath("RayCast3D")
item_name = "Double-barrel shotgun"
item_drop_sound = ExtResource("3")

[node name="Effects" type="Node3D" parent="." index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0161471, -0.493225)
script = ExtResource("2")
smoke_particles = ExtResource("11")
sound_effect = ExtResource("8")
hit_effect = ExtResource("10")

[node name="Flash" type="OmniLight3D" parent="Effects" index="0"]
visible = false
light_color = Color(0.760784, 0.364706, 0.0470588, 1)
light_energy = 5.0
shadow_enabled = true
omni_range = 6.0
omni_attenuation = 7.0

[node name="FlashTimer" type="Timer" parent="Effects/Flash" index="0"]
one_shot = true

[node name="SmokeOrigin" type="Marker3D" parent="Effects" index="1"]

[node name="SoundOrigin" type="Marker3D" parent="Effects" index="2"]

[node name="DoubleBarrel" parent="." index="1" instance=ExtResource("8_6b3p7")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, -0.103214, -1.1961, 0.371749)

[node name="DoubleBarrel_Arm" parent="DoubleBarrel" index="0"]
transform = Transform3D(0.0128653, 3.75386e-08, -0.999917, -8.2623e-08, 1, 3.64787e-08, 0.999917, 8.21469e-08, 0.0128653, -0.100429, 1.20161, 0.39003)

[node name="Skeleton3D" parent="DoubleBarrel/DoubleBarrel_Arm" index="0"]
bones/1/rotation = Quaternion(9.99678e-08, 5.05101e-07, -0.176108, 0.984371)
bones/4/rotation = Quaternion(-0.703679, -0.0693164, 0.703724, -0.0693122)

[node name="DoubleBarrel_Mesh" parent="DoubleBarrel/DoubleBarrel_Arm/Skeleton3D" index="0"]
script = ExtResource("1")

[node name="ShellPosition1" type="Marker3D" parent="DoubleBarrel/DoubleBarrel_Arm/Skeleton3D/DoubleBarrel_Mesh" index="0"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0307579, 0.0281707, -0.0139875)

[node name="ShellPosition2" type="Marker3D" parent="DoubleBarrel/DoubleBarrel_Arm/Skeleton3D/DoubleBarrel_Mesh" index="1"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0307579, 0.0281707, 0.0113859)

[node name="MeshInstance3D" parent="." index="2"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, 0, 0)
layers = 0
mesh = null
skin = SubResource("375")
script = null

[node name="CollisionShape3D" parent="." index="3"]
transform = Transform3D(-4.37114e-08, 0, 1, 0, 1, 0, -1, 0, -4.37114e-08, 0, -0.0358443, -0.0272417)
shape = SubResource("378")

[node name="RayCast3D" parent="." index="7"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000195906, 0.0237, 0.0842745)
visible = true

[node name="Sounds" type="Node3D" parent="." index="8"]

[node name="Unsheath" type="AudioStreamPlayer3D" parent="Sounds" index="0"]
bus = &"Effects"

[node name="Sheath" type="AudioStreamPlayer3D" parent="Sounds" index="1"]
bus = &"Effects"

[node name="Dryfire" type="AudioStreamPlayer3D" parent="Sounds" index="2"]
stream = ExtResource("4")
bus = &"Effects"

[node name="Reload" type="AudioStreamPlayer3D" parent="Sounds" index="3"]
stream = ExtResource("5")
bus = &"Effects"

[node name="Unload" type="AudioStreamPlayer3D" parent="Sounds" index="4"]
stream = ExtResource("12")
bus = &"Effects"

[node name="HoldPosition" parent="." index="9"]
transform = Transform3D(0.913258, -0.0287745, -0.406364, -0.00427967, 0.996769, -0.0801989, 0.407359, 0.0749814, 0.910185, 0.058, 0.039, -0.176)

[node name="AnimationPlayer" type="AnimationPlayer" parent="." index="10"]
unique_name_in_owner = true
root_node = NodePath("../DoubleBarrel")
libraries = {
"": SubResource("AnimationLibrary_wc5fn")
}

[node name="ShellReloadEffects" type="Node" parent="AnimationPlayer" index="0"]
script = ExtResource("13")
impulse_position_1 = Vector3(1, 2, 0.2)
impulse_position_2 = Vector3(1, 2, 0.2)

[connection signal="on_shoot" from="." to="Effects" method="_on_GunItem_on_shoot"]
[connection signal="target_hit" from="." to="Effects" method="_on_GunItem_target_hit"]
[connection signal="timeout" from="Effects/Flash/FlashTimer" to="Effects" method="_on_FlashTimer_timeout"]

[editable path="DoubleBarrel"]
